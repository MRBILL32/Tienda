<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Carrito de Compras</title>
    <meta charset="UTF-8">
</head>
<body>
    <h1>Carrito de Compras</h1>

    <table border="1">
        <thead>
            <tr>
                <th>Producto</th>
                <th>Precio Unitario</th>
                <th>Cantidad</th>
                <th>Subtotal</th>
                <th>Acci√≥n</th>
            </tr>
        </thead>
        <tbody>
            <tr th:each="detalle : ${carrito}">
                <td th:text="${detalle.producto.nomProd}">Nombre</td>
                <td th:text="${detalle.precioUnit}">0.00</td>
                <td th:text="${detalle.cantidad}">1</td>
                <td th:text="${detalle.subtotal}">0.00</td>
                <td>
                    <form method="post" th:action="@{/cliente/eliminarDelCarrito}">
                        <input type="hidden" name="idProd" th:value="${detalle.producto.idProd}">
                        <button type="submit" class="btn btn-danger">Eliminar</button>
                    </form>
                </td>
            </tr>
        </tbody>
        <tfoot>
            <tr>
                <td colspan="3" style="text-align: right;"><strong>Total:</strong></td>
                <td colspan="2" th:text="${#numbers.formatDecimal(carrito.stream().map(d -> d.subtotal).reduce(T(java.math.BigDecimal).ZERO, (a,b) -> a.add(b)), 1, 'POINT', 2, 'NONE')}">0.00</td>
            </tr>
        </tfoot>
    </table>

    <br>
    <a href="/cliente/inicio">Seguir Comprando</a>
    <a href="/cliente/procesarCompra">Finalizar Compra</a>

    <form method="post" th:action="@{/cliente/vaciarCarrito}">
        <button type="submit" class="btn btn-warning">Vaciar Carrito</button>
    </form>
</body>
</html>

